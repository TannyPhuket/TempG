<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üîê Smart Cold Guard Login</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-database.js";

    // üîß Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBHCnAFJHBz95ugYztMkxBa5b6fwqCZqfo",
      authDomain: "temperature-cold-guard.firebaseapp.com",
      databaseURL: "https://temperature-cold-guard-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "temperature-cold-guard",
      storageBucket: "temperature-cold-guard.firebasestorage.app",
      messagingSenderId: "29693405672",
      appId: "1:29693405672:web:9815de4ba98e7e4cf3dc5d",
      measurementId: "G-XDHBRJ9S3W"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // üéØ Login Function
    async function loginUser() {
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value.trim();
      const msg = document.getElementById("msg");

      if (!email || !password) {
        msg.textContent = "‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô";
        msg.classList.remove("hidden");
        return;
      }

      try {
        const userRef = ref(db, "users/" + email.replace(".", "@"));
        const snapshot = await get(userRef);

        if (!snapshot.exists()) {
          msg.textContent = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö";
          msg.classList.remove("hidden");
          return;
        }

        const userData = snapshot.val();
        const userRole = userData.Role;

        // üí° ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÉ‡∏ô Firebase ‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡πÉ‡∏ô‡∏ô‡∏µ‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢
        msg.classList.add("hidden");

        // üîÑ Redirect ‡∏ï‡∏≤‡∏° Role
        if (userRole === "Seller") {
          window.location.href = "dashboard.html";
        } else if (userRole === "Buyer") {
          window.location.href = "buyer.html";
        } else if (userRole === "Driver") {
          window.location.href = "driver.html";
        } else {
          msg.textContent = "‚ö†Ô∏è Role ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
          msg.classList.remove("hidden");
        }
      } catch (error) {
        console.error(error);
        msg.textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö";
        msg.classList.remove("hidden");
      }
    }

    // üì≤ ‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
    document.addEventListener("keypress", (e) => {
      if (e.key === "Enter") loginUser();
    });

    window.loginUser = loginUser;
  </script>
</head>

<body class="bg-gradient-to-br from-blue-100 via-white to-blue-50 min-h-screen flex items-center justify-center font-sans">

  <div class="bg-white shadow-2xl rounded-3xl p-10 w-full max-w-md text-center">
    <h1 class="text-3xl font-bold text-blue-600 mb-6">‚ùÑÔ∏è Smart Cold Guard</h1>
    <p class="text-gray-500 mb-8">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏π‡πâ‡πÄ‡∏¢‡πá‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>

    <input
      id="email"
      type="text"
      placeholder="Email (‡πÄ‡∏ä‡πà‡∏ô Seller@Test.com)"
      class="w-full px-4 py-3 mb-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 outline-none"
    />

    <input
      id="password"
      type="password"
      placeholder="Password (‡πÉ‡∏™‡πà‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö)"
      class="w-full px-4 py-3 mb-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 outline-none"
    />

    <button
      onclick="loginUser()"
      class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-all shadow-md"
    >
      üîì ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
    </button>

    <p id="msg" class="hidden mt-4 text-red-500 font-medium"></p>

    <footer class="mt-8 text-sm text-gray-400">
      ¬© 2025 Smart Cold Guard System<br>
      Developed with ‚ù§Ô∏è by AI
    </footer>
  </div>

</body>
</html>
